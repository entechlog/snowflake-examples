{{
    config(
        alias="player_metrics",
        materialized="incremental",
        unique_key='player_id',
        transient=false,
        tags=["dw", "fact"],
        on_schema_change="sync_all_columns",
    )
}}

with
    source as (
        select {{ dbt_utils.star(ref("prep__fact_cricinfo_player_metrics")) }}
        from {{ ref("prep__fact_cricinfo_player_metrics") }}
    )

select
    {{ dbt_utils.generate_surrogate_key(["player_cricinfo_key"]) }} as player_id,
    odi_batting_balls_faced,
    odi_batting_average,
    odi_batting_strike_rate,
    odi_batting_boundary_fours,
    odi_batting_boundary_sixes,
    odi_batting_ducks_scored,
    odi_batting_highest_score,
    odi_batting_hundreds_scored,
    odi_batting_innings_batted,
    odi_batting_matches_played,
    odi_batting_not_outs,
    odi_batting_playing_span,
    odi_batting_runs_scored,
    odi_batting_scores_50_99,
    odi_bowling_best_in_a_match,
    odi_bowling_best_in_an_inning,
    odi_bowling_average,
    odi_bowling_strike_rate,
    odi_bowling_economy_rate,
    odi_bowling_five_wickets,
    odi_bowling_innings_bowled,
    odi_bowling_maidens_earned,
    odi_bowling_matches_played,
    odi_bowling_overs_bowled,
    odi_bowling_playing_span,
    odi_bowling_runs_conceded,
    odi_bowling_ten_wickets,
    odi_bowling_wickets_taken,
    odi_fielding_catches_as_fielder,
    odi_fielding_catches_as_keeper,
    odi_fielding_catches_taken,
    odi_fielding_dismissals_per_inning,
    odi_fielding_dismissals_made,
    odi_fielding_innings_fielded,
    odi_fielding_matches_played,
    odi_fielding_max_dismissals,
    odi_fielding_playing_span,
    odi_fielding_stumpings_made,
    t20_batting_balls_faced,
    t20_batting_average,
    t20_batting_strike_rate,
    t20_batting_boundary_fours,
    t20_batting_boundary_sixes,
    t20_batting_ducks_scored,
    t20_batting_highest_score,
    t20_batting_hundreds_scored,
    t20_batting_innings_batted,
    t20_batting_matches_played,
    t20_batting_not_outs,
    t20_batting_playing_span,
    t20_batting_runs_scored,
    t20_batting_scores_50_99,
    t20_bowling_best_in_a_match,
    t20_bowling_best_in_an_inning,
    t20_bowling_average,
    t20_bowling_strike_rate,
    t20_bowling_economy_rate,
    t20_bowling_five_wickets,
    t20_bowling_innings_bowled,
    t20_bowling_maidens_earned,
    t20_bowling_matches_played,
    t20_bowling_overs_bowled,
    t20_bowling_playing_span,
    t20_bowling_runs_conceded,
    t20_bowling_ten_wickets,
    t20_bowling_wickets_taken,
    t20_fielding_catches_as_fielder,
    t20_fielding_catches_as_keeper,
    t20_fielding_catches_taken,
    t20_fielding_dismissals_per_inning,
    t20_fielding_dismissals_made,
    t20_fielding_innings_fielded,
    t20_fielding_matches_played,
    t20_fielding_max_dismissals,
    t20_fielding_playing_span,
    t20_fielding_stumpings_made,
    test_batting_balls_faced,
    test_batting_average,
    test_batting_strike_rate,
    test_batting_boundary_fours,
    test_batting_boundary_sixes,
    test_batting_ducks_scored,
    test_batting_highest_score,
    test_batting_hundreds_scored,
    test_batting_innings_batted,
    test_batting_matches_played,
    test_batting_not_outs,
    test_batting_playing_span,
    test_batting_runs_scored,
    test_batting_scores_50_99,
    test_bowling_best_in_a_match,
    test_bowling_best_in_an_inning,
    test_bowling_average,
    test_bowling_strike_rate,
    test_bowling_economy_rate,
    test_bowling_five_wickets,
    test_bowling_innings_bowled,
    test_bowling_maidens_earned,
    test_bowling_matches_played,
    test_bowling_overs_bowled,
    test_bowling_playing_span,
    test_bowling_runs_conceded,
    test_bowling_ten_wickets,
    test_bowling_wickets_taken,
    test_fielding_catches_as_fielder,
    test_fielding_catches_as_keeper,
    test_fielding_catches_taken,
    test_fielding_dismissals_per_inning,
    test_fielding_dismissals_made,
    test_fielding_innings_fielded,
    test_fielding_matches_played,
    test_fielding_max_dismissals,
    test_fielding_playing_span,
    test_fielding_stumpings_made
from source src
